-- PROYECTO FINAL DE BASES DE DATOS --
-- PAMELA JESUS MURILLO ANCHIA --

/** ELIMINACION Y SELECCIÓN DE TABLAS **/
DROP TABLE CONTRATOS;
DROP TABLE FACTURAS;
DROP TABLE APARTAMENTOS;
DROP TABLE EDIFICIOS;
DROP TABLE TIPOS;
DROP TABLE GAMAS;
DROP TABLE CONTACTOS;
DROP TABLE EMPLEADOS;
DROP TABLE PUESTOS;
DROP TABLE INQUILINOS;
DROP TABLE DIRECCIONES;
DROP TABLE DISTRITOS;
DROP TABLE CANTONES;
DROP TABLE PROVINCIAS;

SELECT * FROM CONTRATOS;
SELECT * FROM FACTURAS;
SELECT * FROM APARTAMENTOS;
SELECT * FROM EDIFICIOS;
SELECT * FROM TIPOS;
SELECT * FROM GAMAS;
SELECT * FROM CONTACTOS;
SELECT * FROM EMPLEADOS;
SELECT * FROM PUESTOS;
SELECT * FROM INQUILINOS;
SELECT * FROM DIRECCIONES;
SELECT * FROM DISTRITOS;
SELECT * FROM CANTONES;
SELECT * FROM PROVINCIAS;

/** CREACION DE TABLAS **/

CREATE TABLE PROVINCIAS (
    ID_PROVINCIA NUMBER(1) CONSTRAINT PK_PROVINCIA PRIMARY KEY,
    NOMBRE_PROVINCIA VARCHAR2(15)
);

CREATE TABLE CANTONES (
    ID_CANTON NUMBER(2) CONSTRAINT PK_CANTON PRIMARY KEY,
    ID_PROVINCIA NUMBER(1),
    NOMBRE_CANTON VARCHAR2(50)
);

ALTER TABLE CANTONES ADD CONSTRAINT FK_CANTON_PROVINCIA FOREIGN KEY (ID_PROVINCIA)
REFERENCES PROVINCIAS (ID_PROVINCIA);

CREATE TABLE DISTRITOS (
    ID_DISTRITO NUMBER(2) CONSTRAINT PK_DISTRITO PRIMARY KEY,
    ID_CANTON NUMBER(2),
    ID_PROVINCIA NUMBER(1),
    NOMBRE_DISTRITO VARCHAR2(50)
);

ALTER TABLE DISTRITOS ADD CONSTRAINT FK_DISTRITO_CANTON FOREIGN KEY (ID_CANTON)
REFERENCES CANTONES (ID_CANTON);

ALTER TABLE DISTRITOS ADD CONSTRAINT FK_DISTRITO_PROVINCIA FOREIGN KEY (ID_PROVINCIA)
REFERENCES PROVINCIAS (ID_PROVINCIA);

CREATE TABLE DIRECCIONES (
    ID_DIRECCION NUMBER(2) CONSTRAINT PK_DIRECCION PRIMARY KEY,
    ID_PROVINCIA NUMBER(1),
    ID_CANTON NUMBER(2),
    ID_DISTRITO NUMBER(2),
    DETALLE VARCHAR2(150)
);

ALTER TABLE DIRECCIONES ADD CONSTRAINT FK_DIRECCION_PROVINCIA FOREIGN KEY (ID_PROVINCIA)
REFERENCES PROVINCIAS (ID_PROVINCIA);

ALTER TABLE DIRECCIONES ADD CONSTRAINT FK_DIRECCION_CANTON FOREIGN KEY (ID_CANTON)
REFERENCES CANTONES (ID_CANTON);

ALTER TABLE DIRECCIONES ADD CONSTRAINT FK_DIRECCION_DISTRITO FOREIGN KEY (ID_DISTRITO)
REFERENCES DISTRITOS (ID_DISTRITO);

CREATE TABLE INQUILINOS (
    ID_INQUILINO NUMBER(2) CONSTRAINT PK_INQUILINO PRIMARY KEY,
    NOMBRE VARCHAR2(100),
    APELLIDO1 VARCHAR2(100),
    APELLIDO2 VARCHAR2(100),
    FECHA_NACIMIENTO DATE,
    GENERO CHAR,
    CATEGORIA VARCHAR2(50)
);

ALTER TABLE INQUILINOS ADD CONSTRAINT CK_GENERO CHECK (GENERO IN ('F','M'));

CREATE TABLE PUESTOS (
    ID_PUESTO NUMBER(2) CONSTRAINT PK_PUESTO PRIMARY KEY,
    NOMBRE_PUESTO VARCHAR2(100),
    SALARIO_MENSUAL NUMBER(10),
    TIPO_JORNADA VARCHAR2(15),
    HORAS_JORNADA NUMBER(2),
    SALARIO_JORNADA NUMBER(10),
    DURACION_CONTRATO_MESES NUMBER(2),
    TIPO_CONTRATO VARCHAR2(50)
);

CREATE TABLE EMPLEADOS (
    ID_EMPLEADO NUMBER(2) CONSTRAINT PK_EMPLEADO PRIMARY KEY,
    NOMBRE VARCHAR2(100),
    APELLIDO1 VARCHAR2(100),
    APELLIDO2 VARCHAR2(100),
    FECHA_NACIMIENTO DATE,
    GENERO CHAR,
    ID_PUESTO NUMBER(2),
    ID_DIRECCION NUMBER(2),
    ID_JEFE NUMBER(2)
);

ALTER TABLE EMPLEADOS ADD CONSTRAINT FK_EMPLEADOS_PUESTO FOREIGN KEY (ID_PUESTO)
REFERENCES PUESTOS (ID_PUESTO);

ALTER TABLE EMPLEADOS ADD CONSTRAINT FK_EMPLEADOS_DIRECCION FOREIGN KEY (ID_DIRECCION)
REFERENCES DIRECCIONES (ID_DIRECCION);

ALTER TABLE EMPLEADOS ADD CONSTRAINT FK_EMPLEADOS_JEFE FOREIGN KEY (ID_JEFE)
REFERENCES EMPLEADOS (ID_EMPLEADO);

ALTER TABLE EMPLEADOS ADD CONSTRAINT CK_GENERO_EMPLEADOS CHECK (GENERO IN ('F','M'));

CREATE TABLE CONTACTOS (
    ID_CONTACTO NUMBER(2) CONSTRAINT PK_CONTACTO PRIMARY KEY,
    ID_EMPLEADO NUMBER(2),
    TIPO_CONTACTO VARCHAR2(20),
    VALOR_CONTACTO VARCHAR2(100),
    ESTADO VARCHAR2(20)
);

ALTER TABLE CONTACTOS ADD CONSTRAINT FK_CONTACTOS_EMPLEADO FOREIGN KEY (ID_EMPLEADO)
REFERENCES EMPLEADOS (ID_EMPLEADO);

CREATE TABLE GAMAS (
    ID_GAMA NUMBER(2) CONSTRAINT PK_GAMA PRIMARY KEY,
    NOMBRE_GAMA VARCHAR2(50),
    ACABADOS VARCHAR2(50),
    ADICION_AL_PRECIO NUMBER(3,2)
);

CREATE TABLE TIPOS (
    ID_TIPO NUMBER(2) CONSTRAINT PK_TIPO PRIMARY KEY,
    CANTIDAD_HABITACIONES NUMBER(2),
    CANTIDAD_BANOS NUMBER(2),
    ID_GAMA NUMBER(2),
    PRECIO_BASE NUMBER(20)
);
	
ALTER TABLE TIPOS ADD CONSTRAINT FK_TIPOS_GAMA FOREIGN KEY (ID_GAMA)
REFERENCES GAMAS (ID_GAMA);

CREATE TABLE EDIFICIOS (
    ID_EDIFICIO NUMBER(2) CONSTRAINT PK_EDIFICIO PRIMARY KEY,
    DIRECCION VARCHAR2(200),
    FECHA_COMPRA DATE,
    PRECIO_COMPRA NUMBER(10),
    DUENO_REGISTRADO NUMBER(2),
    ENCARGADO NUMBER(2)
);

ALTER TABLE EDIFICIOS ADD CONSTRAINT FK_EDIFICIO_DUENO FOREIGN KEY (DUENO_REGISTRADO)
REFERENCES EMPLEADOS (ID_EMPLEADO);

ALTER TABLE EDIFICIOS ADD CONSTRAINT FK_EDIFICIO_ENCARGADO FOREIGN KEY (ENCARGADO)
REFERENCES EMPLEADOS (ID_EMPLEADO);


CREATE TABLE APARTAMENTOS (
    ID_APARTAMENTO NUMBER(2) CONSTRAINT PK_APARTAMENTO PRIMARY KEY,
    ID_EDIFICIO NUMBER(2),
    ID_TIPO NUMBER(2),
    ESTADO VARCHAR2(30),
    NUMERO_APARTAMENTO NUMBER(2)
);

ALTER TABLE APARTAMENTOS ADD CONSTRAINT FK_APARTAMENTO_EDIFICIO FOREIGN KEY (ID_EDIFICIO)
REFERENCES EDIFICIOS (ID_EDIFICIO);

ALTER TABLE APARTAMENTOS ADD CONSTRAINT FK_APARTAMENTO_TIPO FOREIGN KEY (ID_TIPO)
REFERENCES TIPOS (ID_TIPO);


CREATE TABLE FACTURAS (
    ID_FACTURA NUMBER(10) CONSTRAINT PK_FACTURA PRIMARY KEY,
    ID_CLIENTE NUMBER(2),
    COBRADOR NUMBER(2),
    FECHA_CORTE DATE,
    FECHA_PAGO DATE,
    PERIODOS_PAGADOS NUMBER(2),
    MONTO NUMBER(15)
);

ALTER TABLE FACTURAS ADD CONSTRAINT FK_FACTURA_CLIENTE FOREIGN KEY (ID_CLIENTE)
REFERENCES INQUILINOS (ID_INQUILINO);

ALTER TABLE FACTURAS ADD CONSTRAINT FK_FACTURA_COBRADOR FOREIGN KEY (COBRADOR)
REFERENCES EMPLEADOS (ID_EMPLEADO);

CREATE TABLE CONTRATOS (
    ID_CONTRATO NUMBER(2) CONSTRAINT  PK_CONTRATO PRIMARY KEY,
    ID_CLIENTE NUMBER(2),
    ID_APARTAMENTO NUMBER(2),
    FECHA_INICIO DATE,
    FECHA_FINAL DATE,
    PRECIO_MENSUAL NUMBER(10)
);

ALTER TABLE CONTRATOS ADD CONSTRAINT FK_CONTRATO_INQUILINO FOREIGN KEY (ID_CLIENTE)
REFERENCES INQUILINOS (ID_INQUILINO);

ALTER TABLE CONTRATOS ADD CONSTRAINT FK_CONTRATO_APARTAMENTO FOREIGN KEY (ID_APARTAMENTO)
REFERENCES APARTAMENTOS(ID_APARTAMENTO);

/** INSERCION DE DATOS **/

-- PROVINCIAS
INSERT INTO PROVINCIAS (ID_PROVINCIA, NOMBRE_PROVINCIA) 
VALUES (1, 'San José');
INSERT INTO PROVINCIAS (ID_PROVINCIA, NOMBRE_PROVINCIA) 
VALUES (2, 'Alajuela');
INSERT INTO PROVINCIAS (ID_PROVINCIA, NOMBRE_PROVINCIA) 
VALUES (3, 'Cartago');
INSERT INTO PROVINCIAS (ID_PROVINCIA, NOMBRE_PROVINCIA) 
VALUES (4, 'Heredia');
INSERT INTO PROVINCIAS (ID_PROVINCIA, NOMBRE_PROVINCIA) 
VALUES (5, 'Guanacaste');
INSERT INTO PROVINCIAS (ID_PROVINCIA, NOMBRE_PROVINCIA) 
VALUES (6, 'Puntarenas');
INSERT INTO PROVINCIAS (ID_PROVINCIA, NOMBRE_PROVINCIA) 
VALUES (7, 'Limón');

-- CANTONES
INSERT INTO CANTONES (ID_CANTON, ID_PROVINCIA, NOMBRE_CANTON)
VALUES (1,1,'San José');
INSERT INTO CANTONES (ID_CANTON, ID_PROVINCIA, NOMBRE_CANTON)
VALUES (2,1,'Desamparados');
INSERT INTO CANTONES (ID_CANTON, ID_PROVINCIA, NOMBRE_CANTON)
VALUES (3,2,'San Carlos');
INSERT INTO CANTONES (ID_CANTON, ID_PROVINCIA, NOMBRE_CANTON)
VALUES (4,2,'Naranjo');
INSERT INTO CANTONES (ID_CANTON, ID_PROVINCIA, NOMBRE_CANTON)
VALUES (5,3,'Turrialba');
INSERT INTO CANTONES (ID_CANTON, ID_PROVINCIA, NOMBRE_CANTON)
VALUES (6,3,'Cartago');
INSERT INTO CANTONES (ID_CANTON, ID_PROVINCIA, NOMBRE_CANTON)
VALUES (7,4,'San Rafael');
INSERT INTO CANTONES (ID_CANTON, ID_PROVINCIA, NOMBRE_CANTON)
VALUES (8,4,'Sarapiquí');
INSERT INTO CANTONES (ID_CANTON, ID_PROVINCIA, NOMBRE_CANTON)
VALUES (9,5,'Cañas');
INSERT INTO CANTONES (ID_CANTON, ID_PROVINCIA, NOMBRE_CANTON)
VALUES (10,5,'Carrillo');
INSERT INTO CANTONES (ID_CANTON, ID_PROVINCIA, NOMBRE_CANTON)
VALUES (11,6,'Golfito');
INSERT INTO CANTONES (ID_CANTON, ID_PROVINCIA, NOMBRE_CANTON)
VALUES (12,6,'Quepos');
INSERT INTO CANTONES (ID_CANTON, ID_PROVINCIA, NOMBRE_CANTON)
VALUES (13,7,'Limón');
INSERT INTO CANTONES (ID_CANTON, ID_PROVINCIA, NOMBRE_CANTON)
VALUES (14,7,'Pococí');

-- DISTRITOS
INSERT INTO DISTRITOS (ID_DISTRITO, ID_CANTON, ID_PROVINCIA, NOMBRE_DISTRITO) 
VALUES (1, 1, 1, 'Carmen');
INSERT INTO DISTRITOS (ID_DISTRITO, ID_CANTON, ID_PROVINCIA, NOMBRE_DISTRITO) 
VALUES (2, 2, 1, 'San Antonio');
INSERT INTO DISTRITOS (ID_DISTRITO, ID_CANTON, ID_PROVINCIA, NOMBRE_DISTRITO) 
VALUES (3, 3, 2, 'Quesada');
INSERT INTO DISTRITOS (ID_DISTRITO, ID_CANTON, ID_PROVINCIA, NOMBRE_DISTRITO) 
VALUES (4, 4, 2, 'San Juan');
INSERT INTO DISTRITOS (ID_DISTRITO, ID_CANTON, ID_PROVINCIA, NOMBRE_DISTRITO) 
VALUES (5, 5, 3, 'La Suiza');
INSERT INTO DISTRITOS (ID_DISTRITO, ID_CANTON, ID_PROVINCIA, NOMBRE_DISTRITO) 
VALUES (6, 6, 3, 'Dulce Nombre');
INSERT INTO DISTRITOS (ID_DISTRITO, ID_CANTON, ID_PROVINCIA, NOMBRE_DISTRITO) 
VALUES (7, 7, 4, 'San Josecito');
INSERT INTO DISTRITOS (ID_DISTRITO, ID_CANTON, ID_PROVINCIA, NOMBRE_DISTRITO) 
VALUES (8, 8, 4, 'La Virgen');
INSERT INTO DISTRITOS (ID_DISTRITO, ID_CANTON, ID_PROVINCIA, NOMBRE_DISTRITO) 
VALUES (9, 9, 5, 'Bebedero');
INSERT INTO DISTRITOS (ID_DISTRITO, ID_CANTON, ID_PROVINCIA, NOMBRE_DISTRITO) 
VALUES (10, 10, 5, 'Filadelfia');
INSERT INTO DISTRITOS (ID_DISTRITO, ID_CANTON, ID_PROVINCIA, NOMBRE_DISTRITO) 
VALUES (11, 11, 6, 'Pavón');
INSERT INTO DISTRITOS (ID_DISTRITO, ID_CANTON, ID_PROVINCIA, NOMBRE_DISTRITO) 
VALUES (12, 12, 6, 'Savegre');
INSERT INTO DISTRITOS (ID_DISTRITO, ID_CANTON, ID_PROVINCIA, NOMBRE_DISTRITO) 
VALUES (13, 13, 7, 'Matama');
INSERT INTO DISTRITOS (ID_DISTRITO, ID_CANTON, ID_PROVINCIA, NOMBRE_DISTRITO) 
VALUES (14, 14, 7, 'La Rita');

-- DIRECCIONES
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (1, 4, 8, 8, 'Frente al parque');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (2, 7, 13, 13, 'En una casa con verja blanca');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO) 
VALUES (3, 7, 13, 13);
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (4, 3, 5, 5, 'A la par del árbol de manzana');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (5, 5, 9, 9, 'Junto al carro rojo');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO) 
VALUES (6, 4, 7, 7);
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (7, 4, 8, 8, '150m al este del cine');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (8, 4, 8, 8, 'Entre dos casas amarillas');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (9, 4, 8, 8, '25 al oeste de donde pintan uñas');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (10, 6, 12, 12, 'Detrás de Tía Panchita');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (11, 7, 13, 13, 'Junto a la peluquera');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO) 
VALUES (12, 1, 2, 2);
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (13, 6, 12, 12, 'A la par del la barbería');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (14, 3, 6, 6, 'Enfrente del gimnasio');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (15, 3, 5, 5, 'A la izquierda de la muchacha que se llama Lana');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (16, 1, 2, 2, 'Junto a la inglesia');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO) 
VALUES (17, 7, 13, 13);
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (18, 1, 2, 2, 'Frente a una casa roja');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO) 
VALUES (19, 4, 8, 8);
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (20, 1, 2, 2, '200m al este del Walmart');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (21, 6, 12, 12, 'Frente a la pulpería "Girasol"');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (22, 1, 1, 1, 'En la calle que tiene al teatro');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO, DETALLE) 
VALUES (23, 5, 9, 9, 'Donde está el carro negro parqueado');
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO) 
VALUES (24, 5, 10, 10);
INSERT INTO DIRECCIONES (ID_DIRECCION, ID_PROVINCIA, ID_CANTON, ID_DISTRITO) 
VALUES (25, 1, 1, 1);

-- INQUILINOS
INSERT INTO INQUILINOS (ID_INQUILINO, NOMBRE, APELLIDO1, APELLIDO2, FECHA_NACIMIENTO, GENERO, CATEGORIA) 
VALUES (1, 'Marcio', 'Rocha', 'Gutiérrez', to_date('1994-06-19', 'RRRR-MM-DD'), 'M', 'Puntal');
INSERT INTO INQUILINOS (ID_INQUILINO, NOMBRE, APELLIDO1, APELLIDO2, FECHA_NACIMIENTO, GENERO, CATEGORIA) 
VALUES (2, 'Cecilia', 'Rodriguez', 'Gutiérrez', to_date('1990-06-01', 'RRRR-MM-DD'), 'F', 'Puntal');
INSERT INTO INQUILINOS (ID_INQUILINO, NOMBRE, APELLIDO1, APELLIDO2, FECHA_NACIMIENTO, GENERO, CATEGORIA) 
VALUES (3, 'Wilfredo', 'Quesada', 'Núñez', to_date('1995-01-10', 'RRRR-MM-DD'), 'M', 'Impuntual');
INSERT INTO INQUILINOS (ID_INQUILINO, NOMBRE, APELLIDO1, APELLIDO2, FECHA_NACIMIENTO, GENERO, CATEGORIA) 
VALUES (4, 'Jessica', 'Guzmán', 'Murillo', to_date('1980-01-01', 'RRRR-MM-DD'), 'F', 'Puntal');
INSERT INTO INQUILINOS (ID_INQUILINO, NOMBRE, APELLIDO1, APELLIDO2, FECHA_NACIMIENTO, GENERO, CATEGORIA) 
VALUES (5, 'Josué', 'Gutiérrez', 'Rocha', to_date('1999-12-25', 'RRRR-MM-DD'), 'M', 'Puntal');
INSERT INTO INQUILINOS (ID_INQUILINO, NOMBRE, APELLIDO1, APELLIDO2, FECHA_NACIMIENTO, GENERO, CATEGORIA) 
VALUES (6, 'Mariela', 'Chaparro', 'Rojas', to_date('2000-11-15', 'RRRR-MM-DD'), 'F', 'Impuntual');
INSERT INTO INQUILINOS (ID_INQUILINO, NOMBRE, APELLIDO1, APELLIDO2, FECHA_NACIMIENTO, GENERO, CATEGORIA) 
VALUES (7, 'Ana', 'Chávez', 'Rodriguez', to_date('1988-01-01', 'RRRR-MM-DD'), 'F', 'Puntal');
INSERT INTO INQUILINOS (ID_INQUILINO, NOMBRE, APELLIDO1, APELLIDO2, FECHA_NACIMIENTO, GENERO, CATEGORIA) 
VALUES (8, 'David', 'Rojas', 'Quesada', to_date('1996-01-01', 'RRRR-MM-DD'), 'M', 'Puntal');
INSERT INTO INQUILINOS (ID_INQUILINO, NOMBRE, APELLIDO1, APELLIDO2, FECHA_NACIMIENTO, GENERO, CATEGORIA) 
VALUES (9, 'Paulina', 'Mora', 'Jiménez', to_date('1980-01-01', 'RRRR-MM-DD'), 'F', 'Puntal');
INSERT INTO INQUILINOS (ID_INQUILINO, NOMBRE, APELLIDO1, APELLIDO2, FECHA_NACIMIENTO, GENERO, CATEGORIA) 
VALUES (10, 'Ruth', 'Guzmán', 'Rodríguez', to_date('2002-01-01', 'RRRR-MM-DD'), 'F', 'Puntal');
INSERT INTO INQUILINOS (ID_INQUILINO, NOMBRE, APELLIDO1, APELLIDO2, FECHA_NACIMIENTO, GENERO, CATEGORIA) 
VALUES (11, 'Selena', 'Núñez', 'Chaparro', to_date('2000-01-15', 'RRRR-MM-DD'), 'F', 'Impuntual');
INSERT INTO INQUILINOS (ID_INQUILINO, NOMBRE, APELLIDO1, APELLIDO2, FECHA_NACIMIENTO, GENERO, CATEGORIA) 
VALUES (12, 'Soledad', 'Gutiérrez', 'Rojas', to_date('1966-02-20', 'RRRR-MM-DD'), 'F', 'Puntal');
INSERT INTO INQUILINOS (ID_INQUILINO, NOMBRE, APELLIDO1, APELLIDO2, FECHA_NACIMIENTO, GENERO, CATEGORIA) 
VALUES (13, 'Rosalía', 'Rojas', 'Mora', to_date('2004-01-30', 'RRRR-MM-DD'), 'F', 'Puntal');
INSERT INTO INQUILINOS (ID_INQUILINO, NOMBRE, APELLIDO1, APELLIDO2, FECHA_NACIMIENTO, GENERO, CATEGORIA) 
VALUES (14, 'Sebastián', NULL, 'Guzmán', to_date('1993-08-22', 'RRRR-MM-DD'), 'M', 'Puntal');
INSERT INTO INQUILINOS (ID_INQUILINO, NOMBRE, APELLIDO1, APELLIDO2, FECHA_NACIMIENTO, GENERO, CATEGORIA) 
VALUES (15, 'Marina', 'Rodríguez', 'Quesada', to_date('2000-07-11', 'RRRR-MM-DD'), 'F', 'Puntal');

-- PUESTOS
INSERT INTO PUESTOS (ID_PUESTO, NOMBRE_PUESTO, SALARIO_MENSUAL, TIPO_JORNADA, HORAS_JORNADA, SALARIO_JORNADA, DURACION_CONTRATO_MESES, TIPO_CONTRATO) 
VALUES (1, 'Conserje', 240000, 'Nocturno', 6, 2000, 24, 'Empleado');
INSERT INTO PUESTOS (ID_PUESTO, NOMBRE_PUESTO, SALARIO_MENSUAL, TIPO_JORNADA, HORAS_JORNADA, SALARIO_JORNADA, DURACION_CONTRATO_MESES, TIPO_CONTRATO) 
VALUES (2, 'Guarda Nocturno', 640000, 'Nocturno', 8, 4000, 6, 'Empleado');
INSERT INTO PUESTOS (ID_PUESTO, NOMBRE_PUESTO, SALARIO_MENSUAL, TIPO_JORNADA, HORAS_JORNADA, SALARIO_JORNADA, DURACION_CONTRATO_MESES, TIPO_CONTRATO) 
VALUES (3, 'Guarda Diurno', 324000, 'Diurno', 6, 2700, 6, 'Empleado');
INSERT INTO PUESTOS (ID_PUESTO, NOMBRE_PUESTO, SALARIO_MENSUAL, TIPO_JORNADA, HORAS_JORNADA, SALARIO_JORNADA, DURACION_CONTRATO_MESES, TIPO_CONTRATO) 
VALUES (4, 'Cobrador', 120000, 'Diurno', 4, 1500, 12, 'Servicios profesionales');
INSERT INTO PUESTOS (ID_PUESTO, NOMBRE_PUESTO, SALARIO_MENSUAL, TIPO_JORNADA, HORAS_JORNADA, SALARIO_JORNADA, DURACION_CONTRATO_MESES, TIPO_CONTRATO) 
VALUES (5, 'Contador', 200000, 'Diurno', 4, 2500, 1, 'Servicios profesionales');
INSERT INTO PUESTOS (ID_PUESTO, NOMBRE_PUESTO, SALARIO_MENSUAL, TIPO_JORNADA, HORAS_JORNADA, SALARIO_JORNADA, DURACION_CONTRATO_MESES, TIPO_CONTRATO) 
VALUES (6, 'Encargado', 1360000, 'Diurno', 8, 8500, 24, 'Empleado');
INSERT INTO PUESTOS (ID_PUESTO, NOMBRE_PUESTO, SALARIO_MENSUAL, TIPO_JORNADA, HORAS_JORNADA, SALARIO_JORNADA, DURACION_CONTRATO_MESES, TIPO_CONTRATO) 
VALUES (7, 'Constructor', 224000, 'Diurno', 4, 2800, 6, 'Servicios profesionales');
INSERT INTO PUESTOS (ID_PUESTO, NOMBRE_PUESTO, SALARIO_MENSUAL, TIPO_JORNADA, HORAS_JORNADA, SALARIO_JORNADA, DURACION_CONTRATO_MESES, TIPO_CONTRATO) 
VALUES (8, 'Coordinador de construcción', 304000, 'Diurno', 4, 3800, 6, 'Servicios profesionales');
INSERT INTO PUESTOS (ID_PUESTO, NOMBRE_PUESTO, SALARIO_MENSUAL, TIPO_JORNADA, HORAS_JORNADA, SALARIO_JORNADA, DURACION_CONTRATO_MESES, TIPO_CONTRATO) 
VALUES (9, 'Jardinero', 224000, 'Diurno', 8, 1400, 12, 'Empleado');

-- EMPLEADOS
SELECT * FROM EMPLEADOS;
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION) 
VALUES (19, 'Sara', 'Guzmán', 'López', 6, to_date('2002-01-01', 'RRRR-MM-DD'), 'F', 19);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (18, 'Olga', 'Arce', 'Rocha', 6, to_date('1980-01-01', 'RRRR-MM-DD'), 'F', 18, 19);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (23, 'Sofía', 'Aguilar', 'Valdelomar', 8, to_date('1993-08-22', 'RRRR-MM-DD'), 'F', 23, 19);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (1, 'Natalia', 'Arce', 'Bayona', 1, to_date('1992-01-01', 'RRRR-MM-DD'), 'F', 1, 18);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (2, 'Noa', 'Rodriguez', 'Quesada', 1, to_date('1990-06-01', 'RRRR-MM-DD'), 'F', 2, 18);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (3, 'Dorita', 'Quesada', 'Madrigal', 1, to_date('1995-01-10', 'RRRR-MM-DD'), 'F', 3, 18);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (4, 'Lucita', 'Jiménez', 'Barquero', 1, to_date('1980-01-01', 'RRRR-MM-DD'), 'F', 4, 18);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (5, 'Carmelo', 'Núñez', 'Mora', 1, to_date('1999-12-25', 'RRRR-MM-DD'), 'M', 5, 18);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (6, 'María', 'Chaparro', 'Guzmán', 1, to_date('1987-11-15', 'RRRR-MM-DD'), 'F', 6, 18);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (7, 'Elena', 'Mora', 'Chávez', 2, to_date('1988-01-01', 'RRRR-MM-DD'), 'F', 7, 18);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (8, 'Norman', 'Rojas', 'Murillo', 2, to_date('1996-01-01', 'RRRR-MM-DD'), 'M', 8, 18);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (9, 'Santiago', 'Bolaños', 'Jiménez', 2, to_date('1980-01-01', 'RRRR-MM-DD'), 'M', 9, 18);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (10, 'Tania', 'Angulo', 'Guzmán', 2, to_date('1966-10-01', 'RRRR-MM-DD'), 'F', 10, 18);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (11, 'Mateo', 'León', 'Soto', 2, to_date('1989-01-15', 'RRRR-MM-DD'), 'M', 11, 19);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (12, 'Bernarda', 'Quesada', 'Rodriguez', 3, to_date('1966-02-20', 'RRRR-MM-DD'), 'F', 12, 19);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (13, 'Elena', 'Vargas', 'Barquero', 3, to_date('1982-01-30', 'RRRR-MM-DD'), 'F', 13, 19);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (14, 'Herminio', 'Murillo', 'Carbajo', 3, to_date('1993-08-22', 'RRRR-MM-DD'), 'M', 14, 19);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (15, 'Cristian', 'Madrigal', 'Franco', 4, to_date('1986-07-11', 'RRRR-MM-DD'), 'M', 15, 19);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (16, 'Merida', 'Mora', 'Anchía', 4, to_date('1988-01-01', 'RRRR-MM-DD'), 'F', 16, 18);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (17, 'Jefferson', 'Jiménez', 'Madrigal', 5, to_date('1996-01-01', 'RRRR-MM-DD'), 'M', 17, 19);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (20, 'Jesús', 'Gutiérrez', 'Mora', 7, to_date('1979-01-15', 'RRRR-MM-DD'), 'M', 20, 23);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (21, 'Marcos', 'Madrigal', 'Murillo', 7, to_date('1966-02-20', 'RRRR-MM-DD'), 'M', 21, 23);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (22, 'Kendall', 'Boza', 'Arce', 7, to_date('1985-01-30', 'RRRR-MM-DD'), 'M', 22, 23);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (24, 'Ofelia', 'Quesada', 'Madrigal', 9, to_date('1990-07-11', 'RRRR-MM-DD'), 'F', 24, 19);
INSERT INTO EMPLEADOS (ID_EMPLEADO, NOMBRE, APELLIDO1, APELLIDO2, ID_PUESTO, FECHA_NACIMIENTO, GENERO, ID_DIRECCION, ID_JEFE) 
VALUES (25, 'Tristana', 'Barquero', 'Jiménez', 9, to_date('1988-01-01', 'RRRR-MM-DD'), 'F', 25, 19);

-- CONTACTOS
INSERT INTO CONTACTOS (ID_CONTACTO, ID_EMPLEADO, TIPO_CONTACTO, VALOR_CONTACTO, ESTADO) 
VALUES (1, 18, 'Correo electrónico', 'olgaarce@gmail.com', 'Activo');
INSERT INTO CONTACTOS (ID_CONTACTO, ID_EMPLEADO, TIPO_CONTACTO, VALOR_CONTACTO, ESTADO) 
VALUES (2, 19, 'Correo electrónico', 'saraguzman@gmail.com', 'Activo');
INSERT INTO CONTACTOS (ID_CONTACTO, ID_EMPLEADO, TIPO_CONTACTO, VALOR_CONTACTO, ESTADO) 
VALUES (3, 23, 'Teléfono', '8499-2039', 'Activo');
INSERT INTO CONTACTOS (ID_CONTACTO, ID_EMPLEADO, TIPO_CONTACTO, VALOR_CONTACTO, ESTADO) 
VALUES (4, 17, 'Teléfono', '8264-4723', 'Inactivo');
INSERT INTO CONTACTOS (ID_CONTACTO, ID_EMPLEADO, TIPO_CONTACTO, VALOR_CONTACTO, ESTADO) 
VALUES (5, 25, 'Teléfono', '8526-3852', 'Activo');

-- GAMAS
INSERT INTO GAMAS (ID_GAMA, NOMBRE_GAMA, ACABADOS, ADICION_AL_PRECIO) VALUES (1,'Basica','Sencillos',1);
INSERT INTO GAMAS (ID_GAMA, NOMBRE_GAMA, ACABADOS, ADICION_AL_PRECIO) VALUES (2,'Normal','Detallados',1.25);
INSERT INTO GAMAS (ID_GAMA, NOMBRE_GAMA, ACABADOS, ADICION_AL_PRECIO) VALUES (3,'Premium','Lujosos',1.5);

-- TIPOS
INSERT INTO TIPOS (ID_TIPO, CANTIDAD_HABITACIONES, CANTIDAD_BANOS, ID_GAMA, PRECIO_BASE) 
VALUES (1, 2, 1, 1, 140000);
INSERT INTO TIPOS (ID_TIPO, CANTIDAD_HABITACIONES, CANTIDAD_BANOS, ID_GAMA, PRECIO_BASE) 
VALUES (2, 3, 1, 2, 180000);
INSERT INTO TIPOS (ID_TIPO, CANTIDAD_HABITACIONES, CANTIDAD_BANOS, ID_GAMA, PRECIO_BASE) 
VALUES (3, 4, 2, 3, 220000);
INSERT INTO TIPOS (ID_TIPO, CANTIDAD_HABITACIONES, CANTIDAD_BANOS, ID_GAMA, PRECIO_BASE) 
VALUES (4, 2, 1, 3, 140000);
INSERT INTO TIPOS (ID_TIPO, CANTIDAD_HABITACIONES, CANTIDAD_BANOS, ID_GAMA, PRECIO_BASE) 
VALUES (5, 3, 1, 2, 180000);
INSERT INTO TIPOS (ID_TIPO, CANTIDAD_HABITACIONES, CANTIDAD_BANOS, ID_GAMA, PRECIO_BASE) 
VALUES (6, 4, 2, 1, 220000);

-- EDIFICIOS
INSERT INTO EDIFICIOS (ID_EDIFICIO, DIRECCION, FECHA_COMPRA, PRECIO_COMPRA, DUENO_REGISTRADO) 
VALUES (1, 'Carmen, San José', to_date('1992-01-01', 'RRRR-MM-DD'), 55000000, 19);
INSERT INTO EDIFICIOS (ID_EDIFICIO, DIRECCION, FECHA_COMPRA, PRECIO_COMPRA, DUENO_REGISTRADO) 
VALUES (2, 'San Carlos, Alajuela', to_date('2000-11-15', 'RRRR-MM-DD'), 80000000, 19);
INSERT INTO EDIFICIOS (ID_EDIFICIO, DIRECCION, FECHA_COMPRA, PRECIO_COMPRA, DUENO_REGISTRADO) 
VALUES (3, 'Turrilba, Cartago', to_date('1992-01-01', 'RRRR-MM-DD'), 30000000, 19);
INSERT INTO EDIFICIOS (ID_EDIFICIO, DIRECCION, FECHA_COMPRA, PRECIO_COMPRA, DUENO_REGISTRADO) 
VALUES (4, 'Sarapiquí, Heredia', to_date('1990-06-01', 'RRRR-MM-DD'), 95000000, 19);
INSERT INTO EDIFICIOS (ID_EDIFICIO, DIRECCION, FECHA_COMPRA, PRECIO_COMPRA, DUENO_REGISTRADO) 
VALUES (5, 'Carrillo, Guanacaste', to_date('1996-01-01', 'RRRR-MM-DD'), 70000000, 19);
INSERT INTO EDIFICIOS (ID_EDIFICIO, DIRECCION, FECHA_COMPRA, PRECIO_COMPRA, DUENO_REGISTRADO) 
VALUES (6, 'Quepos, Puntarenas', to_date('2000-01-15', 'RRRR-MM-DD'), 40000000, 19);
INSERT INTO EDIFICIOS (ID_EDIFICIO, DIRECCION, FECHA_COMPRA, PRECIO_COMPRA, DUENO_REGISTRADO) 
VALUES (7, 'Matama, Limón', to_date('2002-01-01', 'RRRR-MM-DD'), 25000000, 19);

-- APARTAMENTOS
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (1, 1, 3, 'OCUPADO', 1);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (2, 1, 3, 'OCUPADO', 2);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (3, 2, 3, 'DESOCUPADO', 1);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (4, 2, 4, 'DESOCUPADO', 2);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (5, 2, 5, 'OCUPADO', 3);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (6, 2, 2, 'OCUPADO', 4);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (7, 2, 6, 'DESOCUPADO', 5);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (8, 2, 5, 'DESOCUPADO', 6);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (9, 3, 2, 'OCUPADO', 1);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (10, 4, 6, 'OCUPADO', 1);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (11, 4, 4, 'OCUPADO', 2);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (12, 4, 4, 'OCUPADO', 3);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (13, 4, 2, 'OCUPADO', 4);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (14, 4, 2, 'OCUPADO', 5);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (15, 5, 2, 'OCUPADO', 1);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (16, 5, 2, 'OCUPADO', 2);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (17, 5, 3, 'DESOCUPADO', 3);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (18, 5, 1, 'OCUPADO', 4);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (19, 6, 1, 'OCUPADO', 1);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (20, 6, 4, 'OCUPADO', 2);
INSERT INTO APARTAMENTOS (ID_APARTAMENTO, ID_EDIFICIO, ID_TIPO, ESTADO, NUMERO_APARTAMENTO) 
VALUES (21, 7, 3, 'DESOCUPADO', 1);

-- FACTURAS
INSERT INTO FACTURAS (ID_FACTURA, ID_CLIENTE, COBRADOR, FECHA_CORTE, FECHA_PAGO, PERIODOS_PAGADOS, MONTO) 
VALUES (1, 1, 15, to_date('2021-01-15', 'RRRR-MM-DD'), to_date('2021-01-15', 'RRRR-MM-DD'), 12, 3960000);
INSERT INTO FACTURAS (ID_FACTURA, ID_CLIENTE, COBRADOR, FECHA_CORTE, FECHA_PAGO, PERIODOS_PAGADOS, MONTO) 
VALUES (2, 2, 15, to_date('2021-01-15', 'RRRR-MM-DD'), to_date('2021-01-15', 'RRRR-MM-DD'), 12, 3960000);
INSERT INTO FACTURAS (ID_FACTURA, ID_CLIENTE, COBRADOR, FECHA_CORTE, FECHA_PAGO, PERIODOS_PAGADOS, MONTO) 
VALUES (3, 3, 16, to_date('2020-04-10', 'RRRR-MM-DD'), to_date('2020-04-22', 'RRRR-MM-DD'), 1, 405000);
INSERT INTO FACTURAS (ID_FACTURA, ID_CLIENTE, COBRADOR, FECHA_CORTE, FECHA_PAGO, PERIODOS_PAGADOS, MONTO) 
VALUES (4, 4, 16, to_date('2021-02-10', 'RRRR-MM-DD'), to_date('2021-02-10', 'RRRR-MM-DD'), 2, 450000);
INSERT INTO FACTURAS (ID_FACTURA, ID_CLIENTE, COBRADOR, FECHA_CORTE, FECHA_PAGO, PERIODOS_PAGADOS, MONTO) 
VALUES (5, 5, 16, to_date('2021-02-22', 'RRRR-MM-DD'), to_date('2021-02-22', 'RRRR-MM-DD'), 1, 225000);
INSERT INTO FACTURAS (ID_FACTURA, ID_CLIENTE, COBRADOR, FECHA_CORTE, FECHA_PAGO, PERIODOS_PAGADOS, MONTO) 
VALUES (6, 6, 15, to_date('2021-02-11', 'RRRR-MM-DD'), to_date('2021-02-18', 'RRRR-MM-DD'), 1, 220000);
INSERT INTO FACTURAS (ID_FACTURA, ID_CLIENTE, COBRADOR, FECHA_CORTE, FECHA_PAGO, PERIODOS_PAGADOS, MONTO) 
VALUES (7, 7, 15, to_date('2021-06-08', 'RRRR-MM-DD'), to_date('2021-06-08', 'RRRR-MM-DD'), 2, 420000);
INSERT INTO FACTURAS (ID_FACTURA, ID_CLIENTE, COBRADOR, FECHA_CORTE, FECHA_PAGO, PERIODOS_PAGADOS, MONTO) 
VALUES (8, 8, 15, to_date('2021-01-24', 'RRRR-MM-DD'), to_date('2021-01-24', 'RRRR-MM-DD'), 2, 420000);
INSERT INTO FACTURAS (ID_FACTURA, ID_CLIENTE, COBRADOR, FECHA_CORTE, FECHA_PAGO, PERIODOS_PAGADOS, MONTO) 
VALUES (9, 9, 16, to_date('2021-03-28', 'RRRR-MM-DD'), to_date('2021-03-28', 'RRRR-MM-DD'), 1, 225000);
INSERT INTO FACTURAS (ID_FACTURA, ID_CLIENTE, COBRADOR, FECHA_CORTE, FECHA_PAGO, PERIODOS_PAGADOS, MONTO) 
VALUES (10, 10, 16, to_date('2021-07-13', 'RRRR-MM-DD'), to_date('2021-07-13', 'RRRR-MM-DD'), 2, 450000);
INSERT INTO FACTURAS (ID_FACTURA, ID_CLIENTE, COBRADOR, FECHA_CORTE, FECHA_PAGO, PERIODOS_PAGADOS, MONTO) 
VALUES (11, 11, 16, to_date('2021-05-13', 'RRRR-MM-DD'), to_date('2021-05-20', 'RRRR-MM-DD'), 1, 225000);
INSERT INTO FACTURAS (ID_FACTURA, ID_CLIENTE, COBRADOR, FECHA_CORTE, FECHA_PAGO, PERIODOS_PAGADOS, MONTO) 
VALUES (12, 12, 15, to_date('2021-02-17', 'RRRR-MM-DD'), to_date('2021-02-17', 'RRRR-MM-DD'), 2, 450000);
INSERT INTO FACTURAS (ID_FACTURA, ID_CLIENTE, COBRADOR, FECHA_CORTE, FECHA_PAGO, PERIODOS_PAGADOS, MONTO) 
VALUES (13, 13, 15, to_date('2021-02-13', 'RRRR-MM-DD'), to_date('2021-02-13', 'RRRR-MM-DD'), 2, 280000);
INSERT INTO FACTURAS (ID_FACTURA, ID_CLIENTE, COBRADOR, FECHA_CORTE, FECHA_PAGO, PERIODOS_PAGADOS, MONTO) 
VALUES (14, 14, 15, to_date('2021-09-19', 'RRRR-MM-DD'), to_date('2021-09-19', 'RRRR-MM-DD'), 1, 140000);
INSERT INTO FACTURAS (ID_FACTURA, ID_CLIENTE, COBRADOR, FECHA_CORTE, FECHA_PAGO, PERIODOS_PAGADOS, MONTO) 
VALUES (15, 15, 16, to_date('2021-07-11', 'RRRR-MM-DD'), to_date('2021-07-11', 'RRRR-MM-DD'), 1, 210000);

-- CONTRATOS
INSERT INTO CONTRATOS (ID_CONTRATO, ID_CLIENTE, ID_APARTAMENTO, FECHA_INICIO, FECHA_FINAL, PRECIO_MENSUAL) 
VALUES (1, 1, 1, to_date('2021-01-15', 'RRRR-MM-DD'), to_date('2021-07-15', 'RRRR-MM-DD'), 330000);
INSERT INTO CONTRATOS (ID_CONTRATO, ID_CLIENTE, ID_APARTAMENTO, FECHA_INICIO, FECHA_FINAL, PRECIO_MENSUAL) 
VALUES (2, 2, 2, to_date('2021-01-15', 'RRRR-MM-DD'), to_date('2021-07-15', 'RRRR-MM-DD'), 330000);
INSERT INTO CONTRATOS (ID_CONTRATO, ID_CLIENTE, ID_APARTAMENTO, FECHA_INICIO, FECHA_FINAL, PRECIO_MENSUAL) 
VALUES (3, 3, 5, to_date('2020-04-10', 'RRRR-MM-DD'), to_date('2020-10-10', 'RRRR-MM-DD'), 405000);
INSERT INTO CONTRATOS (ID_CONTRATO, ID_CLIENTE, ID_APARTAMENTO, FECHA_INICIO, FECHA_FINAL, PRECIO_MENSUAL) 
VALUES (4, 4, 6, to_date('2021-02-10', 'RRRR-MM-DD'), to_date('2022-02-10', 'RRRR-MM-DD'), 225000);
INSERT INTO CONTRATOS (ID_CONTRATO, ID_CLIENTE, ID_APARTAMENTO, FECHA_INICIO, FECHA_FINAL, PRECIO_MENSUAL) 
VALUES (5, 5, 9, to_date('2021-02-22', 'RRRR-MM-DD'), to_date('2021-08-22', 'RRRR-MM-DD'), 225000);
INSERT INTO CONTRATOS (ID_CONTRATO, ID_CLIENTE, ID_APARTAMENTO, FECHA_INICIO, FECHA_FINAL, PRECIO_MENSUAL) 
VALUES (6, 6, 10, to_date('2021-02-11', 'RRRR-MM-DD'), to_date('2022-12-20', 'RRRR-MM-DD'), 220000);
INSERT INTO CONTRATOS (ID_CONTRATO, ID_CLIENTE, ID_APARTAMENTO, FECHA_INICIO, FECHA_FINAL, PRECIO_MENSUAL) 
VALUES (7, 7, 11, to_date('2021-06-08', 'RRRR-MM-DD'), to_date('2021-12-08', 'RRRR-MM-DD'), 210000);
INSERT INTO CONTRATOS (ID_CONTRATO, ID_CLIENTE, ID_APARTAMENTO, FECHA_INICIO, FECHA_FINAL, PRECIO_MENSUAL) 
VALUES (8, 8, 12, to_date('2021-01-24', 'RRRR-MM-DD'), to_date('2021-07-15', 'RRRR-MM-DD'), 210000);
INSERT INTO CONTRATOS (ID_CONTRATO, ID_CLIENTE, ID_APARTAMENTO, FECHA_INICIO, FECHA_FINAL, PRECIO_MENSUAL) 
VALUES (9, 9, 13, to_date('2021-03-28', 'RRRR-MM-DD'), to_date('2020-10-10', 'RRRR-MM-DD'), 225000);
INSERT INTO CONTRATOS (ID_CONTRATO, ID_CLIENTE, ID_APARTAMENTO, FECHA_INICIO, FECHA_FINAL, PRECIO_MENSUAL) 
VALUES (10, 10, 14, to_date('2021-07-13', 'RRRR-MM-DD'), to_date('2022-07-13', 'RRRR-MM-DD'), 225000);
INSERT INTO CONTRATOS (ID_CONTRATO, ID_CLIENTE, ID_APARTAMENTO, FECHA_INICIO, FECHA_FINAL, PRECIO_MENSUAL) 
VALUES (11, 11, 15, to_date('2021-05-13', 'RRRR-MM-DD'), to_date('2023-05-13', 'RRRR-MM-DD'), 225000);
INSERT INTO CONTRATOS (ID_CONTRATO, ID_CLIENTE, ID_APARTAMENTO, FECHA_INICIO, FECHA_FINAL, PRECIO_MENSUAL) 
VALUES (12, 12, 16, to_date('2021-02-17', 'RRRR-MM-DD'), to_date('2021-08-17', 'RRRR-MM-DD'), 225000);
INSERT INTO CONTRATOS (ID_CONTRATO, ID_CLIENTE, ID_APARTAMENTO, FECHA_INICIO, FECHA_FINAL, PRECIO_MENSUAL) 
VALUES (13, 13, 18, to_date('2021-02-13', 'RRRR-MM-DD'), to_date('2021-08-13', 'RRRR-MM-DD'), 140000);
INSERT INTO CONTRATOS (ID_CONTRATO, ID_CLIENTE, ID_APARTAMENTO, FECHA_INICIO, FECHA_FINAL, PRECIO_MENSUAL) 
VALUES (14, 14, 19, to_date('2021-09-19', 'RRRR-MM-DD'), to_date('2022-09-19', 'RRRR-MM-DD'), 140000);
INSERT INTO CONTRATOS (ID_CONTRATO, ID_CLIENTE, ID_APARTAMENTO, FECHA_INICIO, FECHA_FINAL, PRECIO_MENSUAL) 
VALUES (15, 15, 20, to_date('2021-07-11', 'RRRR-MM-DD'), to_date('2022-07-11', 'RRRR-MM-DD'), 210000);
INSERT INTO CONTRATOS (ID_CONTRATO, ID_CLIENTE, ID_APARTAMENTO, FECHA_INICIO, FECHA_FINAL, PRECIO_MENSUAL) 
VALUES (16, 1, 2, to_date('2021-07-15', 'RRRR-MM-DD'), to_date('2022-07-15', 'RRRR-MM-DD'), 330000);
INSERT INTO CONTRATOS (ID_CONTRATO, ID_CLIENTE, ID_APARTAMENTO, FECHA_INICIO, FECHA_FINAL, PRECIO_MENSUAL) 
VALUES (17, 2, 1, to_date('2021-07-15', 'RRRR-MM-DD'), to_date('2022-07-15', 'RRRR-MM-DD'), 330000);

/** ALTERACION DE DATOS **/ 

-- 1. Se quiere cambiar el encargado de cédula 18 a cédula 19 en los edificios de identificación 1, 3, 4 y 5.
-- 2. Se quiere actualizar el estado de “desocupado” a “ocupado”, para aquellos apartamentos con contratos activos.
-- 3. Los inquilinos que no paguen con menos de tres días de retraso obtienen la categoría de “impuntual”.
-- 4. El tipo de contacto era por defecto “teléfono”.  Ahora se quiere cambiar a “correo electrónico”, aquellos contactos que contienen una arroba en ellos.
-- 5. Se le quiere cambiar el estado del contacto de “activo” a “inactivo”, a la persona de cédula 17.
-- 6. Se van a borrar todos los contactos que tengan estado “inactivo”.
-- 7. Cambiar el tipo de contrato de “Empleado” a “Servicios profesionales”, si el id del puesto esta dentro de esta lista (4, 5, 7,8).
-- 8. Si el tipo de jornada dice nocturno, poner su cantidad de horas en 6, si su tipo de contrato es por servicios profesionales, poner cantidad de horas a 4.
-- 9. Actualizar el salario mensual utilizando la cantidad de horas, el salario por hora y suponiendo que se trabajan 20 días al mes.
-- 10. Actualizar el monto de la factura al periodo multiplicado por la cantidad de dinero que cuesta cada apartamento.
-- 11. Cambiar el error de ortografía de “jarjofnereo” a “Jardinero”, para el puesto de identificación 9.


-- 1. Se quiere cambiar el encargado de cédula 18 a cédula 19 en los edificios de identificación 1, 3, 4 y 5.

SELECT * FROM EDIFICIOS;
UPDATE EDIFICIOS SET ENCARGADO = 18; --Reinicia la tabla

UPDATE EDIFICIOS
SET ENCARGADO = 19
WHERE ID_EDIFICIO IN (1, 3, 4, 5);

-- 2. Se quiere actualizar el estado de “desocupado” a “ocupado”, para aquellos apartamentos con contratos activos.

SELECT * FROM APARTAMENTOS;
UPDATE APARTAMENTOS SET ESTADO = 'DESOCUPADO'; --Reinicia la tabla

UPDATE APARTAMENTOS A
SET A.ESTADO = 'OCUPADO'
WHERE EXISTS (
	SELECT C.ID_APARTAMENTO, FECHA_FINAL FROM CONTRATOS C
	WHERE A.ID_APARTAMENTO = C.ID_APARTAMENTO
	AND FECHA_FINAL > CURRENT_DATE
);

-- 3. Los inquilinos que no paguen con menos de tres días de retraso obtienen la categoría de “impuntual”.

SELECT * FROM INQUILINOS;
UPDATE INQUILINOS SET CATEGORIA = 'PUNTUAL'; --Reinicia la tabla

UPDATE INQUILINOS I
SET I.CATEGORIA = 'IMPUNTUAL'
WHERE EXISTS(
	SELECT FA.ID_CLIENTE FROM FACTURAS FA
	WHERE FECHA_PAGO >= FECHA_CORTE + 3
    AND I.ID_INQUILINO = FA.ID_CLIENTE
);

-- 4. El tipo de contacto era por defecto “teléfono”.  Ahora se quiere cambiar a “correo electrónico”, aquellos contactos que contienen una arroba en ellos.

SELECT * FROM CONTACTOS;
UPDATE CONTACTOS SET TIPO_CONTACTO = 'TELÉFONO'; -- Reiniciar tabla

UPDATE CONTACTOS
SET TIPO_CONTACTO = 'CORREO ELECTRÓNICO'
WHERE VALOR_CONTACTO LIKE '%@%';

-- 5. Se le quiere cambiar el estado del contacto de “activo” a “inactivo”, a la persona de cédula 17.

SELECT * FROM CONTACTOS;
UPDATE CONTACTOS SET ESTADO = 'ACTIVO';

UPDATE CONTACTOS
SET ESTADO = 'INACTIVO'
WHERE ID_EMPLEADO = 17;

-- 6. Se van a borrar todos los contactos que tengan estado “inactivo”.

SELECT * FROM CONTACTOS;
INSERT INTO CONTACTOS (ID_CONTACTO, ID_EMPLEADO, TIPO_CONTACTO, VALOR_CONTACTO, ESTADO) VALUES (4, 17, 'Teléfono', '8264-4723', 'Inactivo'); -- Reinicia la tabla

DELETE FROM CONTACTOS
WHERE ESTADO = 'INACTIVO';

-- 7. Cambiar el tipo de contrato de “Empleado” a “Servicios profesionales”, si el id del puesto esta dentro de esta lista (4, 5, 7,8).

SELECT * FROM PUESTOS;
UPDATE PUESTOS SET TIPO_CONTRATO = 'EMPLEADO'; -- Reinicia la tabla

UPDATE PUESTOS
SET TIPO_CONTRATO = 'SERVICIOS PROFESIONALES'
WHERE ID_PUESTO IN (4, 5, 7, 8);

-- 8. Si el tipo de jornada dice nocturno, poner su cantidad de horas en 6, si su tipo de contrato es por servicios profesionales, poner cantidad de horas a 4.

SELECT * FROM PUESTOS;

UPDATE PUESTOS SET HORAS_JORNADA = 8; -- Reinicio de tabla

UPDATE PUESTOS SET HORAS_JORNADA = 6
WHERE UPPER(TIPO_JORNADA) = 'NOCTURNO';

UPDATE PUESTOS SET HORAS_JORNADA = 4
WHERE UPPER(TIPO_CONTRATO) = 'SERVICIOS PROFESIONALES';

-- 9. Actualizar el salario mensual utilizando la cantidad de horas, el salario por hora y suponiendo que se trabajan 20 días al mes.

SELECT * FROM PUESTOS;
UPDATE PUESTOS SET SALARIO_MENSUAL = 0; -- Reinicio de tabla

UPDATE PUESTOS SET SALARIO_MENSUAL = SALARIO_JORNADA*HORAS_JORNADA*20;

-- 10. Cambiar el error de ortografía de “jarjofnereo” a “Jardinero”, para el puesto de identificación 9.

SELECT * FROM PUESTOS;
UPDATE PUESTOS SET NOMBRE_PUESTO = 'jarjofnereo' WHERE ID_PUESTO = 9; --Reinicio de tabla

UPDATE PUESTOS
SET NOMBRE_PUESTO = 'Jardinero'
WHERE ID_PUESTO = 9;

/** CONSULTAS **/

-- 1. Obtener el número de apartamentos por edificio, junto con el id y el nombre del encargado.
-- 2. Obtener la cantidad de hombres y mujeres que hay en el trabajo, así como su salario mensual y distribución por provincia.
-- 3. Obtener la edad de los empleados con al menos un contacto registrado, de mayor a menor, junto con su puesto y tipo de contacto.
-- 4. Mostrar los inquilinos impuntuales que tengan contratos activos. Mostrar también la dirección del edificio en el que se encuentran.
-- 5. Mostrar los inquilinos impuntuales que tengan contratos activos. Mostrar también la dirección del edificio en el que se encuentran.
-- 6. Nombre de los cobradores junto con el dinero máximo que han recaudado en los contratos vigentes.
-- 7. Obtener la provincia, cantón y distrito de cada uno de los empleados.
-- 8. Obtener la edad de los inquilinos, junto con la cantidad de habitaciones que tiene su apartamento y sus acabados, ordenar por cantidad de habitaciones y mostrar únicamente los primeros 5 resultados.


-- 1. Obtener el número de apartamentos por edificio, junto con el id y el nombre del encargado.

SELECT EA.ENCARGADO ID_ENCARGADO, E.NOMBRE  ||' '|| E.APELLIDO1 ||' '|| E.APELLIDO2 NOMBRE_ENCARGADO, COUNT(A.ID_APARTAMENTO) CANTIDAD_APARTAMENTOS
FROM APARTAMENTOS A
LEFT JOIN EDIFICIOS EA
ON EA.ID_EDIFICIO = A.ID_EDIFICIO
LEFT JOIN EMPLEADOS E
ON E.ID_EMPLEADO = EA.ENCARGADO
GROUP BY EA.ENCARGADO, E.NOMBRE  ||' '|| E.APELLIDO1 ||' '|| E.APELLIDO2;

-- 2. Obtener la cantidad de hombres y mujeres que hay en el trabajo y obtener el que tenga mayor salario, ordenar por provincia.

SELECT E.GENERO, P.NOMBRE_PROVINCIA PROVINCIA, MAX(P.SALARIO_MENSUAL) MAYOR_SALARIO, COUNT(E.ID_EMPLEADO) CANTIDAD_EMPLEADOS FROM EMPLEADOS E
LEFT JOIN DIRECCIONES D
ON D.ID_DIRECCION = E.ID_DIRECCION
LEFT JOIN PROVINCIAS P
ON P.ID_PROVINCIA = D.ID_PROVINCIA
LEFT JOIN PUESTOS P
ON P.ID_PUESTO = E.ID_PUESTO
GROUP BY E.GENERO, P.NOMBRE_PROVINCIA
ORDER BY P.NOMBRE_PROVINCIA;

-- 3. Obtener la edad de los empleados con al menos un contacto registrado, de mayor a menor, junto con su puesto y tipo de contacto.
SELECT TRUNC(MONTHS_BETWEEN(SYSDATE, E.FECHA_NACIMIENTO)/12) EDAD_EMPLEADO, P.NOMBRE_PUESTO PUESTO, C.TIPO_CONTACTO FROM EMPLEADOS E
LEFT JOIN PUESTOS P
ON P.ID_PUESTO = E.ID_PUESTO
INNER JOIN CONTACTOS C
ON C.ID_EMPLEADO = E.ID_EMPLEADO
ORDER BY FECHA_NACIMIENTO ASC;

-- 4. Ordenar los empleados cobradores que hayan hecho un cobro por cantidad de cobros de mayor a menor.
SELECT E.ID_EMPLEADO ID_COBRADOR, E.NOMBRE  ||' '|| E.APELLIDO1 ||' '|| E.APELLIDO2 NOMBRE_COBRADOR, COUNT(F.COBRADOR) CANTIDAD_COBROS, J.NOMBRE NOMBRE_JEFE, PJ.SALARIO_MENSUAL SALARIO_MENSUAL_JEFE FROM EMPLEADOS E
LEFT JOIN PUESTOS P
ON P.ID_PUESTO = E.ID_PUESTO
LEFT JOIN EMPLEADOS J
ON E.ID_JEFE = J.ID_EMPLEADO
LEFT JOIN PUESTOS PJ
ON PJ.ID_PUESTO = J.ID_PUESTO
LEFT JOIN FACTURAS F
ON F.COBRADOR = E.ID_EMPLEADO
WHERE UPPER(P.NOMBRE_PUESTO) = 'COBRADOR'
GROUP BY E.ID_EMPLEADO, E.NOMBRE  ||' '|| E.APELLIDO1 ||' '|| E.APELLIDO2, J.NOMBRE, PJ.SALARIO_MENSUAL
ORDER BY COUNT(F.COBRADOR ) DESC;

-- 5. Mostrar los inquilinos impuntuales que tengan contratos activos. Mostrar también la dirección del edificio en el que se encuentran.
SELECT I.*, EA.DIRECCION DIRECCION_EDIFICIO FROM INQUILINOS I
LEFT JOIN CONTRATOS C
ON I.ID_INQUILINO = C.ID_CLIENTE
LEFT JOIN APARTAMENTOS A
ON A.ID_APARTAMENTO = C.ID_APARTAMENTO
LEFT JOIN EDIFICIOS EA
ON EA.ID_EDIFICIO = A.ID_EDIFICIO
WHERE UPPER(I.CATEGORIA) = 'IMPUNTUAL'
AND C.FECHA_FINAL > CURRENT_DATE;

-- 6. Identificacion y nombre de los cobradores junto con el dinero máximo que han recaudado en los contratos vigentes.
SELECT E.ID_EMPLEADO, E.NOMBRE NOMBRE_COBRADOR, MAX(F.MONTO) MAX_MONTO FROM EMPLEADOS E
INNER JOIN FACTURAS F
ON F.COBRADOR = E.ID_EMPLEADO
LEFT JOIN CONTRATOS C
ON C.ID_CLIENTE = F.ID_CLIENTE
WHERE C.FECHA_FINAL > CURRENT_DATE
GROUP BY E.ID_EMPLEADO,E.NOMBRE;

-- 6.1 Lo mismo que el anterior pero con todos los contratos en historia
SELECT E.ID_EMPLEADO, E.NOMBRE NOMBRE_COBRADOR, MAX(F.MONTO) MAX_MONTO FROM EMPLEADOS E
INNER JOIN FACTURAS F
ON F.COBRADOR = E.ID_EMPLEADO
LEFT JOIN CONTRATOS C
ON C.ID_CLIENTE = F.ID_CLIENTE
GROUP BY E.ID_EMPLEADO, E.NOMBRE;

-- 7. Obtener la provincia, cantón y distrito de cada uno de los empleados.
SELECT E.ID_EMPLEADO, E.NOMBRE  ||' '|| E.APELLIDO1 ||' '|| E.APELLIDO2 NOMBRE_EMPLEADO, P.NOMBRE_PROVINCIA, C.NOMBRE_CANTON, DE.NOMBRE_DISTRITO FROM EMPLEADOS E
LEFT JOIN DIRECCIONES D
ON D.ID_DIRECCION = E.ID_DIRECCION
JOIN PROVINCIAS P
ON P.ID_PROVINCIA = D.ID_PROVINCIA
JOIN CANTONES C
ON C.ID_CANTON = D.ID_CANTON
JOIN DISTRITOS DE
ON D.ID_DISTRITO = DE.ID_DISTRITO
ORDER BY P.NOMBRE_PROVINCIA;

-- 8. Obtener la edad de los inquilinos, junto con la cantidad de habitaciones que tiene su apartamento y sus acabados, ordenar por cantidad de habitaciones y mostrar únicamente los primeros 10 resultados.
SELECT * FROM (
    SELECT TRUNC(MONTHS_BETWEEN(SYSDATE, I.FECHA_NACIMIENTO)/12) EDAD_INQUILINO, T.CANTIDAD_HABITACIONES, G.ACABADOS FROM INQUILINOS I
    LEFT JOIN CONTRATOS C
    ON C.ID_CLIENTE = I.ID_INQUILINO
    LEFT JOIN APARTAMENTOS A
    ON C.ID_APARTAMENTO = A.ID_APARTAMENTO
    LEFT JOIN TIPOS T
    ON T.ID_TIPO = A.ID_TIPO
    LEFT JOIN GAMAS G
    ON T.ID_GAMA = G.ID_GAMA
    ORDER BY T.CANTIDAD_HABITACIONES DESC
)
WHERE ROWNUM <= 10;